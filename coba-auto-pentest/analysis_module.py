from flask import Flask, request, jsonify, send_file
import os

app = Flask(__name__)

# Replace this with your function to analyze the URL and generate PDF
from your_analysis_module import main

@app.route('/analyze', methods=['POST'])
def analyze_url():
    data = request.get_json()
    url = data['url']
    
    # Run the analysis
    pdf_report = main(url)
    
    if os.path.exists(pdf_report):
        return jsonify({'pdf_url': pdf_report}), 200
    else:
        return jsonify({'error': 'Failed to generate report'}), 500

@app.route('/<path:filename>', methods=['GET'])
def download_file(filename):
    return send_file(filename, as_attachment=True)

if __name__ == "__main__":
    app.run(debug=True)
